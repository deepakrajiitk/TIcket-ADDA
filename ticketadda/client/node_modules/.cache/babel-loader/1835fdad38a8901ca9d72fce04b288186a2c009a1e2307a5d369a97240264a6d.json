{"ast":null,"code":"\"use strict\";\n\n/*\n * Copyright 2020 IBM All Rights Reserved.\n *\n * SPDX-License-Identifier: Apache-2.0\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.removeListener = exports.addListener = void 0;\nasync function addListener(listener, listenerSessions, sessionSupplier) {\n  if (!listenerSessions.has(listener)) {\n    const session = await sessionSupplier();\n    // Store listener before starting in case start fires error events that trigger remove of the listener\n    listenerSessions.set(listener, session);\n    await session.start();\n  }\n  return listener;\n}\nexports.addListener = addListener;\nfunction removeListener(listener, listenerSessions) {\n  const session = listenerSessions.get(listener);\n  if (session) {\n    session.close();\n    listenerSessions.delete(listener);\n  }\n}\nexports.removeListener = removeListener;","map":{"version":3,"names":["addListener","listener","listenerSessions","sessionSupplier","has","session","set","start","exports","removeListener","get","close","delete"],"sources":["../../../src/impl/event/listenersession.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;AAYO,eAAeA,WAAWA,CAChCC,QAAW,EAAEC,gBAAyC,EAAEC,eAA+C;EACvG,IAAI,CAACD,gBAAgB,CAACE,GAAG,CAACH,QAAQ,CAAC,EAAE;IACpC,MAAMI,OAAO,GAAG,MAAMF,eAAe,EAAE;IACvC;IACAD,gBAAgB,CAACI,GAAG,CAACL,QAAQ,EAAEI,OAAO,CAAC;IACvC,MAAMA,OAAO,CAACE,KAAK,EAAE;;EAEtB,OAAON,QAAQ;AAEhB;AAVAO,OAAA,CAAAR,WAAA,GAAAA,WAAA;AAYA,SAAgBS,cAAcA,CAAIR,QAAW,EAAEC,gBAAyC;EACvF,MAAMG,OAAO,GAAGH,gBAAgB,CAACQ,GAAG,CAACT,QAAQ,CAAC;EAC9C,IAAII,OAAO,EAAE;IACZA,OAAO,CAACM,KAAK,EAAE;IACfT,gBAAgB,CAACU,MAAM,CAACX,QAAQ,CAAC;;AAEnC;AANAO,OAAA,CAAAC,cAAA,GAAAA,cAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}